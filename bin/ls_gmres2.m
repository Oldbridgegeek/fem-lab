function x_0 = ls_gmres2(A,x_0,b,tol)    % Initializations    %h = zeros(size(x_0));    %y = zeros(size(x_0),1);    %v = zeros(size(x_0));    %w = zeros(size(x_0));        % PART 1    r=abs( A*x_0 - b );    y(1) = norm(r);    v(:,1) = r / norm(r);            while ( norm(r) > tol)        for j=1:size(x_0)                    %PART 2            q = A*v(:,j);            for i=1:j                h(i,j)=transpose(v(:,i))*q;            endfor                                    % PART 3            val = 0;            for i=1:j                val =+ h(i,j)*v(:,i) ;            endfor            w(:,j)=q-val;            h(j+1,j) = norm(w(:,j));                                                % PART 4            for i=1:j-1                h(i,j) = c(i+1)*h(i,j) + s(i+1)*h(i+1,j);                h(i+1,j) = c(i+1)*h(i+1,j) - s(i+1)*h(i,j);            endfor            bt = sqrt(h(j,j)^2 + h(j+1,j)^2);            s(j+1)=h(j+1,j);            c(j+1)= h(j,j) / bt;            h(j,j) = bt;            y(j+1)=-s(j+1)*y(j);            y(j)=c(j+1)*y(j);                        % PART 5            if abs(y(j+1)) >= tol                 v(:,j+1)= w(:,j) / h(j+1,j) ;            else                                for i=j:1                    val = 0;                    for k=i+1:j                        val =+ h(i,k) * y(k);                    endfor                    y(i)=(1/h(i,i)) * ( y(i) - val );                endfor                            endif                        % PART 6            val = zeros(size(x_0),1);            for i=1:j                val =+ y(i) * v(:,i);            endfor            x_0 = x_0 + val;                            endfor                r=abs( A*x_0 - b );    endwhileendfunction