<<<<<<< HEAD
function [x,w]=int_gauss_weights(N,a,b)    tic    % This script is for computing definite integrals using Legendre-Gauss     % Quadrature. Computes the Legendre-Gauss nodes and weights  on an interval    % [a,b] with truncation order N    %    % Suppose you have a continuous function f(x) which is defined on [a,b]    % which you can evaluate at any x in [a,b]. Simply evaluate it at all of    % the values contained in the x vector to obtain a vector f. Then compute    % the definite integral using sum(f.*w);    N=N-1;    N1=N+1; N2=N+2;    xu=linspace(-1,1,N1)';    % Initial guess    y=cos((2*(0:N)'+1)*pi/(2*N+2))+(0.27/N1)*sin(pi*xu*N/N2);    % Legendre-Gauss Vandermonde Matrix    L=zeros(N1,N2);    % Derivative of LGVM    Lp=zeros(N1,N2);    % Compute the zeros of the N+1 Legendre Polynomial    % using the recursion relation and the Newton-Raphson method    y0=2;    % Iterate until new points are uniformly within epsilon of old points    while max(abs(y-y0))>eps        L(:,1)=1;        Lp(:,1)=0;        L(:,2)=y;        Lp(:,2)=1;        for k=2:N1            L(:,k+1)=( (2*k-1)*y.*L(:,k)-(k-1)*L(:,k-1) )/k;        endfor        Lp=(N2)*( L(:,N1)-y.*L(:,N2) )./(1-y.^2);           y0=y;        y=y0-L(:,N2)./Lp;    endwhile    % Linear map from[-1,1] to [a,b]    x=(a*(1-y)+b*(1+y))/2;          % Compute the weights    w=(b-a)./((1-y.^2).*Lp.^2)*(N2/N1)^2;    gauss_weight_time=tocendfunction
=======
function [x,w]=int_gauss_weights(n,a,b)    % This function should give us as output the sample points and the weights for interval [a,b] for Legendre-Gauss Quadratur.    % n represents the truncation order.    n=n-1;    n_1=n+1; n_2=n+2;    xu=linspace(-1,1,n_1)';    % Initial guess    y=cos((2*(0:n)'+1)*pi/(2*n+2))+(0.27/n_1)*sin(pi*xu*n/n_2);        % Initialize Vandermonde matrix and Derivative of the Vandermonde matrix    L=zeros(n_1,n_2);    d_L=zeros(n_1,n_2);        % Calculate zeros of n+1 Legendre polynomial with Newton-Raphson method and the recursion relation    y0=2;    % Iterate until new points are uniformly within epsilon of old points    while max(abs(y-y0))>eps        L(:,1)=1;        d_L(:,1)=0;        L(:,2)=y;        d_L(:,2)=1;        for k=2:n_1            L(:,k+1)=( (2*k-1)*y.*L(:,k)-(k-1)*L(:,k-1) )/k;        endfor        d_L=(n_2)*( L(:,n_1)-y.*L(:,n_2) )./(1-y.^2);           y0=y;        y=y0-L(:,n_2)./d_L;    endwhile    % Linear map from [-1,1] to [a,b]    x=(a*(1-y)+b*(1+y))/2;          % Calculate weights    w=(b-a)./((1-y.^2).*d_L.^2)*(n_2/n_1)^2;    endfunction
>>>>>>> 56890e10a90bd28f0f333dc5fc8f8916527561e1
