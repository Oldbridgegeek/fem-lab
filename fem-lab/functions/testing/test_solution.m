function solution = test_solution()    % Solve the problem for mesh size 0.5 and polynomial degree 1    % Shape functions    % 1. Element    shape_function_1 = [1,-2,-2,4;0,2,0,-4;0,0,2,-4;0,0,0,4];        % 2. Element    shape_function_2 = [2,-2,-4,4;-1,2,2,-4;0,0,4,-4;0,0,-2,4];     % 3. Element    shape_function_3 = [2,-4,-2,4;0,4,0,-4;-1,2,2,-4;0,-2,0,4];    % 4. Element    shape_function_4 = [4,-4,-4,4;-2,4,2,-4;-2,2,4,-4;1,-2,-2,4];        % create stiffness matrix    stiffness_matrix = zeros(9,9);        % stiffness_matrix    cell_matrix = mesh_cell(0.5,1);        for i=1:9        for j=1:9            value = 0;            % 1. Element            if ( mesh_renumber(cell_matrix,1,i) != 0 && mesh_renumber(cell_matrix,1,j) != 0 )                shape_function_i = shape_function_1(mesh_renumber(cell_matrix,1,i),:);                shape_function_j = shape_function_1(mesh_renumber(cell_matrix,1,j),:);                [dx_shape_function_i,dy_shape_function_i] = sf_derivate(shape_function_i);                [dx_shape_function_j,dy_shape_function_j] = sf_derivate(shape_function_j);                f = @(x,y) hf_eval_poly(x,y,shape_function_i).*hf_eval_poly(x,y,shape_function_j);                h_1 = @(x,y) hf_eval_poly(x,y,dx_shape_function_i).*hf_eval_poly(x,y,dx_shape_function_j) ;                h_2 = @(x,y) hf_eval_poly(x,y,dy_shape_function_i).*hf_eval_poly(x,y,dy_shape_function_j) ;                value = value +  dblquad(f,0,0.5,0,0.5) + dblquad(h_1,0,0.5,0,0.5) + dblquad(h_2,0,0.5,0,0.5);            endif            % 2. Element            if ( mesh_renumber(cell_matrix,2,i) != 0 && mesh_renumber(cell_matrix,2,j) != 0 )                shape_function_i = shape_function_2(mesh_renumber(cell_matrix,2,i),:);                shape_function_j = shape_function_2(mesh_renumber(cell_matrix,2,j),:);                [dx_shape_function_i,dy_shape_function_i] = sf_derivate(shape_function_i);                [dx_shape_function_j,dy_shape_function_j] = sf_derivate(shape_function_j);                f = @(x,y) hf_eval_poly(x,y,shape_function_i).*hf_eval_poly(x,y,shape_function_j);                h_1 = @(x,y) hf_eval_poly(x,y,dx_shape_function_i).*hf_eval_poly(x,y,dx_shape_function_j) ;                h_2 = @(x,y) hf_eval_poly(x,y,dy_shape_function_i).*hf_eval_poly(x,y,dy_shape_function_j) ;                value = value +  dblquad(f,0.5,1,0,0.5) + dblquad(h_1,0.5,1,0,0.5) + dblquad(h_2,0.5,1,0,0.5);            endif            % 3. Element            if ( mesh_renumber(cell_matrix,3,i) != 0 && mesh_renumber(cell_matrix,3,j) != 0 )                shape_function_i = shape_function_3(mesh_renumber(cell_matrix,3,i),:);                shape_function_j = shape_function_3(mesh_renumber(cell_matrix,3,j),:);                [dx_shape_function_i,dy_shape_function_i] = sf_derivate(shape_function_i);                [dx_shape_function_j,dy_shape_function_j] = sf_derivate(shape_function_j);                f = @(x,y) hf_eval_poly(x,y,shape_function_i).*hf_eval_poly(x,y,shape_function_j);                h_1 = @(x,y) hf_eval_poly(x,y,dx_shape_function_i).*hf_eval_poly(x,y,dx_shape_function_j) ;                h_2 = @(x,y) hf_eval_poly(x,y,dy_shape_function_i).*hf_eval_poly(x,y,dy_shape_function_j) ;                value = value +  dblquad(f,0,0.5,0.5,1) + dblquad(h_1,0,0.5,0.5,1) + dblquad(h_2,0,0.5,0.5,1);            endif            % 4. Element            if ( mesh_renumber(cell_matrix,4,i) != 0 && mesh_renumber(cell_matrix,4,j) != 0 )                shape_function_i = shape_function_4(mesh_renumber(cell_matrix,4,i),:);                shape_function_j = shape_function_4(mesh_renumber(cell_matrix,4,j),:);                [dx_shape_function_i,dy_shape_function_i] = sf_derivate(shape_function_i);                [dx_shape_function_j,dy_shape_function_j] = sf_derivate(shape_function_j);                f = @(x,y) hf_eval_poly(x,y,shape_function_i).*hf_eval_poly(x,y,shape_function_j);                h_1 = @(x,y) hf_eval_poly(x,y,dx_shape_function_i).*hf_eval_poly(x,y,dx_shape_function_j) ;                h_2 = @(x,y) hf_eval_poly(x,y,dy_shape_function_i).*hf_eval_poly(x,y,dy_shape_function_j) ;                value = value +  dblquad(f,0.5,1,0.5,1) + dblquad(h_1,0.5,1,0.5,1) + dblquad(h_2,0.5,1,0.5,1);            endif            stiffness_matrix(i,j) = value;          endfor    endfor                  stiffness_matrix    % create right hand side    rhs = zeros(9,1);    % First node     shape_function_T1 = shape_function_1(1,:);    f_1 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T1);    rhs(1) = dblquad(f_1,0,0.5,0,0.5);        % Second node    shape_function_T1 = shape_function_1(2,:);    shape_function_T2 = shape_function_2(1,:);    f_1 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T1);    f_2 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T2);    rhs(2) = dblquad(f_1,0,0.5,0,0.5) + dblquad(f_2,0.5,1,0,0.5);        % Third node    shape_function_T2 = shape_function_2(2,:);    f = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T2);    rhs(3) = dblquad(f,0.5,1,0,0.5);        % Fourth node    shape_function_T1 = shape_function_1(3,:);    shape_function_T3 = shape_function_3(1,:);    f_1 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T1);    f_3 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T3);    rhs(4) = dblquad(f_1,0,0.5,0,0.5) + dblquad(f_3,0,0.5,0.5,1);        % Fifth node    shape_function_T1 = shape_function_1(4,:);    shape_function_T2 = shape_function_2(3,:);    shape_function_T3 = shape_function_3(2,:);    shape_function_T4 = shape_function_4(1,:);    f_1 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T1);    f_2 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T2);    f_3 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T3);    f_4 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T4);    rhs(5) = dblquad(f_1,0,0.5,0,0.5) + dblquad(f_3,0,0.5,0.5,1) + dblquad(f_2,0.5,1,0,0.5) + dblquad(f_4,0.5,1,0.5,1);        % Sixth node    shape_function_T2 = shape_function_2(4,:);    shape_function_T4 = shape_function_4(2,:);    f_2 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T2);    f_4 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T4);    rhs(6) = dblquad(f_2,0.5,1,0,0.5) + dblquad(f_4,0.5,1,0.5,1);        % Seventh node    shape_function_T3 = shape_function_3(3,:);    f_3 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T3);    rhs(7) = dblquad(f_3,0,0.5,0.5,1);        % Eigth node    shape_function_T3 = shape_function_3(4,:);    shape_function_T4 = shape_function_4(3,:);    f_3 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T3);    f_4 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T4);    rhs(8) = dblquad(f_3,0,0.5,0.5,1) + dblquad(f_4,0.5,1,0.5,1);        % Ninth node    shape_function_T4 = shape_function_4(4,:);    f_4 = @(x,y) cos(pi.*x).*cos(pi.*y).*hf_eval_poly(x,y,shape_function_T4);    rhs(9) = dblquad(f_4,0.5,1,0.5,1);        % pcg = preconditioned conjugated gradient method    solution = stiffness_matrix \ rhs ;endfunction