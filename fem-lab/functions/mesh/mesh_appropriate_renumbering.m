function node_number_local = mesh_appropriate_renumbering2(mesh_size, polynomial_deg, cell_number, node_number_global)    % mesh properties    mesh_cells_per_row=(1/mesh_size);    mesh_nodes_per_row=(polynomial_deg*mesh_cells_per_row)+1;    % calculate node number and cell properties    dimension_domain = 2;    k = 0;    cell_nodes_counter =  (factorial(dimension_domain)/(factorial(k)*factorial(dimension_domain-k))) * polynomial_deg^k * (polynomial_deg+1)^(dimension_domain-k)    cell_row_counter = polynomial_deg + 1 ;    cell_nodes_per_row = cell_nodes_counter / cell_row_counter;    % calculate number of first node of our cell    first_node=1;    cell_number_iterated = 1;    mesh_column_counter = cell_row_counter*mesh_cells_per_row - mesh_cells_per_row;    cell_column=1;    counter=0;    node_nr=0;    step_counter = 0;        found_first_node = 0;        while cell_number_iterated<cell_number        while counter < cell_nodes_counter            for i=node_nr:(cell_nodes_per_row-1+node_nr)            first_node+i                if(first_node+i == node_number_global)                    found_first_node = 1;                endif                counter++;            endfor            node_nr=node_nr+mesh_nodes_per_row;        endwhile                        counter=0;        cell_number_iterated++;                if(!found_first_node)        for k=1:mesh_column_counter            if(first_node+cell_nodes_per_row-1 == mesh_nodes_per_row*k)                first_node = 1+mesh_nodes_per_row*(cell_row_counter-1)                break;            elseif                first_node = first_node + cell_nodes_per_row - 1                break;            endif        endfor        endif    endwhile      first_node   found_first_node           endfunction