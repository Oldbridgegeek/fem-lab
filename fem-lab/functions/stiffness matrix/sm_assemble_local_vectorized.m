function SM_local = sm_assemble_local_vectorized(SF,mesh_size)    tic        % Initialize Gauss Quadratur    degree_polynomial = sqrt(length(SF))-1;    [sample_points,weights] = int_gauss_weights(degree_polynomial*10,0,1);    % Calculate derivates of shape functions    [dx_SF,dy_SF]= sf_derivate(SF);        % Initialize local stiffness matrix    SM_local = zeros(length(SF),length(SF));        % Calculate diagonal matrix    f = @(x,y) (mesh_size^2*hf_eval_poly(x,y,SF)+hf_eval_poly(x,y,dx_SF)+hf_eval_poly(x,y,dy_SF))*(mesh_size^2*hf_eval_poly(x,y,SF)+hf_eval_poly(x,y,dx_SF)+hf_eval_poly(x,y,dy_SF))';    % dblquad integration    % val = dblquad(f,0,1,0,1) + dblquad(h_1,0,1,0,1) + dblquad(h_2,0,1,0,1);    % Gauss quadratur    % Which is exact for polynomials up to order degree_polynomial+1    SM_local = int_gauss(sample_points,weights,sample_points,weights,f);        vectorized=tocendfunction